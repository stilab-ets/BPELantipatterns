<!-- TransferService BPEL Process [Generated by the Oracle BPEL Designer] -->
<process name="TransferService" targetNamespace="http://services.otn.com" suppressJoinFailure="yes" xmlns:tns="http://services.otn.com" xmlns="http://schemas.xmlsoap.org/ws/2003/03/business-process/" xmlns:bpelx="http://schemas.oracle.com/bpel/extension" xmlns:ora="http://schemas.oracle.com/xpath/extension">
	<!-- ================================================================= -->
	<!-- PARTNERLINKS                                                      -->
	<!-- List of services participating in this BPEL process               -->
	<!-- ================================================================= -->
	<partnerLinks>
		<!-- The 'client' role represents the requester of this service. -->
		<partnerLink name="client" partnerLinkType="tns:TransferService" myRole="TransferServiceProvider"/>
	</partnerLinks>
	<!-- ================================================================= -->
	<!-- VARIABLES                                                         -->
	<!-- List of messages and XML documents used within this BPEL process  -->
	<!-- ================================================================= -->
	<variables>
		<!-- Reference to the message passed as input during initiation -->
		<variable messageType="tns:DoTransferServiceRequestMessage" name="inputDoTransfer"/>
		<!-- 
          Reference to the message that will be returned to the requester
          -->
		<variable name="outputDoTransfer" messageType="tns:DoTransferServiceResponseMessage"/>
		<variable name="inputUndoTransfer" messageType="tns:UndoTransferServiceRequestMessage"/>
		<variable name="outputUndoTransfer" messageType="tns:UndoTransferServiceResponseMessage"/>
	</variables>
	<!-- ================================================================= -->
	<!-- ORCHESTRATION LOGIC                                               -->
	<!-- Set of activities coordinating the flow of messages across the    -->
	<!-- services integrated within this business process                  -->
	<!-- ================================================================= -->
	<sequence name="main">
		<!-- Receive input from requester. 
             Note: This maps to operation defined in TransferService.wsdl 
             -->
		<pick name="pickOperation" createInstance="yes">
			<onMessage partnerLink="client" portType="tns:TransferService" operation="doTransfer" variable="inputDoTransfer">
				<sequence><assign name="assignConfirmId"><copy>
							<from expression="string('123456')"></from>
							<to variable="outputDoTransfer" part="payload" query="/tns:DoTransferServiceResponse/tns:confirmId"/>
						</copy>
					</assign>
					<reply name="replyOutput" partnerLink="client" portType="tns:TransferService" operation="doTransfer" variable="outputDoTransfer"/>
				</sequence>
			</onMessage>
			<onMessage partnerLink="client" portType="tns:TransferService" operation="undoTransfer" variable="inputUndoTransfer">
				<sequence>
                                              <assign name="assignStatus"><copy>
							<from expression="string('rollback')"></from>
							<to variable="outputUndoTransfer" part="payload" query="/tns:UndoTransferServiceResponse/tns:status"/>
						</copy>
					</assign>
					<reply xmlns="http://schemas.xmlsoap.org/ws/2003/03/business-process/" name="replyOutput2" partnerLink="client" portType="tns:TransferService" operation="undoTransfer" variable="outputUndoTransfer"/>
				</sequence>
			</onMessage>
		</pick>
		<!-- Generate reply to synchronous request -->
	</sequence>
</process>
